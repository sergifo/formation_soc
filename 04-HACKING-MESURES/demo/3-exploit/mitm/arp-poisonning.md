L'ARP poisoning est une technique utilisée pour intercepter le trafic réseau entre deux machines en falsifiant les réponses ARP (Address Resolution Protocol). Voici les étapes détaillées pour effectuer un ARP poisoning entre une VM Windows et une VM Ubuntu en utilisant Ettercap sur une machine Kali. Vous utiliserez PuTTY sur la VM Windows pour se connecter en telnet sur le port 23 de la VM Ubuntu, et vous verrez les logs sur Ettercap pour observer les opérations effectuées.

### Prérequis

1. **Machine Kali** avec Ettercap installé.
2. **VM Windows** avec PuTTY installé.
3. **VM Ubuntu** avec le service telnet installé et activé.

### Étapes

#### 1. Configuration réseau

Assurez-vous que toutes les machines (Kali, Windows, et Ubuntu) sont sur le même réseau.

#### 2. Installation des outils nécessaires

**Sur la VM Ubuntu**, installez le service telnet :

```bash
sudo apt update
sudo apt install xinetd telnetd
sudo systemctl enable xinetd
sudo systemctl start xinetd
```

Vérifiez que le service telnet est en cours d'exécution :

```bash
sudo systemctl status xinetd
```

#### 3. Préparer la VM Windows pour se connecter via telnet

Téléchargez et installez PuTTY sur la VM Windows. Assurez-vous de connaître l'adresse IP de la VM Ubuntu.

#### 4. Lancer Ettercap sur la machine Kali

Pour autoriser la redirection de port (ou le forwarding) sur une machine Kali Linux, vous devez activer l'option d'IP forwarding. Cela permet à Kali de transférer les paquets réseau entre les interfaces réseau. 

```bash
sudo sysctl -w net.ipv4.ip_forward=1
```

Ouvrez un terminal sur la machine Kali et lancez Ettercap en mode graphique :

```bash
sudo ettercap -G
```

#### 5. Configuration de l'ARP poisoning dans Ettercap

1. **Sélectionner l'interface réseau** :
   - Dans Ettercap, allez dans "Sniff" -> "Unified sniffing".
   - Sélectionnez l'interface réseau connectée au réseau des VMs.

2. **Scanner les hôtes** :
   - Allez dans "Hosts" -> "Scan for hosts".

3. **Ajouter les hôtes à la cible** :
   - Allez dans "Hosts" -> "Hosts list".
   - Ajoutez l'adresse IP de la VM Windows à la cible 1.
   - Ajoutez l'adresse IP de la VM Ubuntu à la cible 2.

4. **Démarrer l'ARP poisoning** :
   - Allez dans "Mitm" -> "ARP poisoning".
   - Sélectionnez "Sniff remote connections" et cliquez sur "OK".

5. **Démarrer la capture** :
   - Allez dans "Start" -> "Start sniffing".

#### 6. Connexion Telnet depuis la VM Windows

Sur la VM Windows, ouvrez PuTTY et configurez une connexion telnet :

1. **Ouvrir PuTTY**.
2. **Configurer la connexion** :
   - Sélectionnez "Telnet".
   - Entrez l'adresse IP de la VM Ubuntu.
   - Entrez le port 23 (par défaut pour telnet).
3. **Connectez-vous**.
4. **Authentifiez-vous** sur la VM Ubuntu en entrant les identifiants de l'utilisateur.

#### 7. Observation des logs sur Ettercap

Retournez sur la machine Kali où Ettercap est en cours d'exécution. Vous devriez voir les paquets capturés dans l'interface graphique d'Ettercap. Les paquets de telnet contenant les commandes et les réponses devraient être visibles.

- Pour voir les paquets en clair, vous pouvez aller dans "View" -> "Connections" pour observer les connexions en cours.
- Les commandes et les réponses entre les VMs seront visibles dans le panneau des logs de Ettercap.

### Résumé

En suivant ces étapes, vous pouvez effectuer une attaque d'ARP poisoning entre une VM Windows et une VM Ubuntu en utilisant Ettercap sur une machine Kali. Vous utiliserez PuTTY sur la VM Windows pour se connecter à la VM Ubuntu via telnet, et vous observerez les logs sur Ettercap pour voir les opérations effectuées.

### Note de sécurité

L'ARP poisoning est une technique d'attaque réseau qui peut avoir des implications légales et éthiques graves. N'utilisez cette méthode que dans un environnement contrôlé et avec l'autorisation explicite des administrateurs réseau concernés.